<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8" />
    <title>Create User</title>
</head>
<body>
<h1>Test: Create User</h1>

<form id="create-user-form">
    <label>Username: <input type="text" id="username" value="testuser" /></label><br>
    <label>First Name: <input type="text" id="first_name" value="Jon" /></label><br>
    <label>Last Name: <input type="text" id="last_name" value="Doe" /></label><br>
    <label>Email: <input type="email" id="email" value="jon@example.com" /></label><br>
    <label>Password: <input type="password" id="password" value="secret123" /></label><br>
    <label>Confirm Password: <input type="password" id="password_confirmation" value="secret123" /></label><br>

    <label>Gender:
        <select id="gender">
            <option value="Male" selected>MALE</option>
            <option value="Female">FEMALE</option>
        </select>
    </label><br>

    <label>Role:
        <select id="role">
            <option value="user" selected>User</option>
            <option value="admin">Admin</option>
        </select>
    </label><br><br>

    <button type="submit">Create User</button>
</form>

<h2>Response:</h2>
<pre id="output"></pre>

<script>
const API_URL = "http://localhost/api/users"; // Upewnij się, że port jest poprawny

function log(message) {
    document.getElementById("output").textContent = message;
}

document.getElementById("create-user-form").addEventListener("submit", async (e) => {
    e.preventDefault();

    const payload = {
        username: document.getElementById("username").value,
        first_name: document.getElementById("first_name").value,
        last_name: document.getElementById("last_name").value,
        email: document.getElementById("email").value,
        password: document.getElementById("password").value,
        password_confirmation: document.getElementById("password_confirmation").value,
        gender: document.getElementById("gender").value, // -> "Male" lub "Female"
        role: document.getElementById("role").value
    };

    try {
        const resp = await fetch(API_URL, {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(payload),
            credentials: "include"
        });

        const data = await resp.json();
        log("Status: " + resp.status + "\n" + JSON.stringify(data, null, 2));
    } catch (err) {
        log("ERROR: " + err);
    }
});
</script>
</body>
</html>
